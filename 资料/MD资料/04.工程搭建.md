# 工程搭建

# 使用模板创建项目
工程名: Bell

# 几个必备配置
| 作用 | 配置名 | 配置值 |
| --- | --- | --- |
| 滴答频率配置为1000Hz | FREERTOS_HZ | 1000 |
| Flash类型 | ESPTOOLPY_FLASHMODE | DOUT |
| Flash大小 | ESPTOOLPY_FLASHSIZE | 8MB |
| Flash速度 | ESPTOOLPY_FLASHFREQ | 80MHz |
| SPI_FLASH的高性能模式 | SPI_FLASH_HPM | Enable |
| 使能外置PSRAM | SPIRAM | ESP PSRAM打勾 |
| 外置RAM的速度 | SPIRAM_SPEED | 80MHz |
| Cpu主频 | ESP_DEFAULT_CPU_FREQ_MHZ | 240MHz |


备注:

由于摄像头产生的数据比较大, 内置RAM不够用, 所以设计了一个外置PSRAM. 需要在配置中进行使能



# 日志系统扩展
esp-idf提供的sdk已经有了比较完善的日志系统, 但是在输出日志的时候不能自动添加文件名和行号,我们对已有日志系统做扩展,能够自动添加文件名和行号, 方便日志的查看

## Com_Debug.c
```c
#include"debug.h"
chartag[100];
```

## Com_Debug.h
```c
#ifndef __COM_DEBUG_H__
#define __COM_DEBUG_H__

#include"esp_log.h"
#include"string.h"
#include"esp_task.h"

#define DEBUG 1

externchartag[100];
#if(DEBUG ==1)

#define MY_LOGE(format, ...)                                \
do {                                                    \
sprintf(tag, "[%10s:%4d]", __FILENAME__, __LINE__); \
ESP_LOGE(tag, format, ##__VA_ARGS__);               \
} while(0)
#define MY_LOGW(format, ...)                                \
do {                                                    \
sprintf(tag, "[%10s:%4d]", __FILENAME__, __LINE__); \
ESP_LOGW(tag, format, ##__VA_ARGS__);               \
} while(0)

#define MY_LOGI(format, ...)                                \
do {                                                    \11
sprintf(tag, "[%10s:%4d]", __FILENAME__, __LINE__); \
ESP_LOGI(tag, format, ##__VA_ARGS__);               \
} while(0)

#define MY_LOGD(format, ...)                                \
do {                                                    \
sprintf(tag, "[%10s:%4d]", __FILENAME__, __LINE__); \
ESP_LOGD(tag, format, ##__VA_ARGS__);               \
} while(0)

#define MY_LOGV(format, ...)                                \
do {                                                    \
sprintf(tag, "[%10s:%4d]", __FILENAME__, __LINE__); \
ESP_LOGV(tag, format, ##__VA_ARGS__);               \
} while(0)
#else
#define MY_LOGE(format, ...)
#define MY_LOGW(format, ...)
#define MY_LOGI(format, ...)
#define MY_LOGD(format, ...)
#define MY_LOGV(format, ...)
#endif
#endif
```
